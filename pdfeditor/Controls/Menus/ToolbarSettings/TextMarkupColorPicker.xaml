<UserControl
	x:Class="pdfeditor.Controls.Menus.ToolbarSettings.TextMarkupColorPicker" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:local="clr-namespace:pdfeditor.Controls.Menus.ToolbarSettings" xmlns:control="clr-namespace:pdfeditor.Controls" xmlns:localprop="clr-namespace:pdfeditor.Properties" xmlns:colorpicker="clr-namespace:CommonLib.Controls.ColorPickers;assembly=CommonLib" xmlns:cv="clr-namespace:pdfeditor.Utils.Converters">
	<Grid>
		<FrameworkElement.Resources>
			<ResourceDictionary>
				<local:StringColorConverter
					x:Key="StringColorConverter" />
				<local:ColorIndicatorConverter
					x:Key="ColorIndicatorConverter" />
				<cv:StringBrushConverter
					x:Key="StringBrushConverter" />
				<Geometry
					x:Key="ColorSelectIndicator">m1.4186,6.19411l3.55283,3.76507l7.42857,-7.95918</Geometry>
				<Style
					x:Key="ColorRadioButtonStyle"
					TargetType="{x:Type RadioButton}">
					<Setter
						Property="Background"
						Value="#00FFFFFF" />
					<Setter
						Property="BorderBrush"
						Value="#99000000" />
					<Setter
						Property="Foreground"
						Value="#00FFFFFF" />
					<Setter
						Property="BorderThickness"
						Value="0" />
					<Setter
						Property="Width"
						Value="16" />
					<Setter
						Property="Height"
						Value="16" />
					<Setter
						Property="FrameworkElement.FocusVisualStyle"
						Value="{x:Null}" />
					<Setter
						Property="Template">
						<Setter.Value>
							<ControlTemplate
								TargetType="{x:Type RadioButton}">
								<Border
									x:Name="bd"
									Background="#00FFFFFF">
									<Grid>
										<Viewbox
											x:Name="content"
											Stretch="Uniform"
											HorizontalAlignment="Stretch"
											VerticalAlignment="Stretch"
											SnapsToDevicePixels="False"
											UseLayoutRounding="False"
											Tag="{TemplateBinding FrameworkElement.Tag}">
											<Grid
												SnapsToDevicePixels="False"
												UseLayoutRounding="False"
												Width="32"
												Height="32">
												<Ellipse
													x:Name="circle"
													HorizontalAlignment="Stretch"
													VerticalAlignment="Stretch"
													Fill="{TemplateBinding Control.Background}"
													SnapsToDevicePixels="False"
													UseLayoutRounding="False" />
												<Image
													x:Name="TransparentImage"
													Source="/Style/Resources/ContextMenu/ToolbarSetting_Transparent.png"
													Stretch="Uniform"
													HorizontalAlignment="Stretch"
													VerticalAlignment="Stretch"
													SnapsToDevicePixels="False"
													UseLayoutRounding="False"
													Visibility="Collapsed" />
											</Grid>
										</Viewbox>
										<Ellipse
											x:Name="border"
											HorizontalAlignment="Stretch"
											VerticalAlignment="Stretch"
											Fill="#00FFFFFF"
											Stroke="{TemplateBinding Control.BorderBrush}"
											StrokeThickness="2"
											Visibility="Collapsed"
											SnapsToDevicePixels="False"
											UseLayoutRounding="False" />
										<Ellipse
											x:Name="SelectedBorder"
											HorizontalAlignment="Stretch"
											VerticalAlignment="Stretch"
											Fill="#00FFFFFF"
											StrokeThickness="1"
											SnapsToDevicePixels="False"
											UseLayoutRounding="False"
											Visibility="Collapsed"
											Opacity="0"
											Stroke="{Binding Path=Tag, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ColorIndicatorConverter}}" />
										<Path
											x:Name="SelectedIndicator"
											StrokeThickness="2"
											HorizontalAlignment="Center"
											VerticalAlignment="Center"
											Visibility="Collapsed"
											Data="{StaticResource ColorSelectIndicator}"
											Stroke="{Binding Path=Tag, RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource ColorIndicatorConverter}}" />
									</Grid>
								</Border>
								<ControlTemplate.Triggers>
									<Trigger
										Property="UIElement.IsMouseOver"
										Value="True">
										<Setter
											TargetName="content"
											Property="UIElement.Opacity"
											Value="0.6" />
									</Trigger>
									<Trigger
										Property="IsPressed"
										Value="True" />
									<Trigger
										Property="ToggleButton.IsChecked"
										Value="true">
										<Setter
											TargetName="content"
											Property="Margin"
											Value="0" />
										<Setter
											TargetName="SelectedIndicator"
											Property="Visibility"
											Value="Visible" />
										<Setter
											TargetName="SelectedBorder"
											Property="Visibility"
											Value="Visible" />
									</Trigger>
									<Trigger
										Property="FrameworkElement.Tag">
										<Trigger.Value>
											<Color>#FFFFFF</Color>
										</Trigger.Value>
										<Setter
											TargetName="circle"
											Property="Shape.Stroke"
											Value="#000000" />
										<Setter
											TargetName="circle"
											Property="Shape.StrokeThickness"
											Value="1" />
									</Trigger>
									<Trigger
										Property="FrameworkElement.Tag">
										<Trigger.Value>
											<Color>#000000</Color>
										</Trigger.Value>
										<Setter
											TargetName="circle"
											Property="Shape.Stroke"
											Value="#FFF" />
										<Setter
											TargetName="circle"
											Property="Shape.StrokeThickness"
											Value="1" />
									</Trigger>
									<DataTrigger
										Value="0"
										Binding="{Binding ElementName=content, Path=Tag.A, Mode=OneWay}">
										<Setter
											TargetName="circle"
											Property="Visibility"
											Value="Collapsed" />
										<Setter
											TargetName="TransparentImage"
											Property="Visibility"
											Value="Visible" />
										<Setter
											TargetName="SelectedIndicator"
											Property="UIElement.Opacity"
											Value="0.8" />
										<Setter
											TargetName="SelectedBorder"
											Property="UIElement.Opacity"
											Value="0.8" />
									</DataTrigger>
								</ControlTemplate.Triggers>
							</ControlTemplate>
						</Setter.Value>
					</Setter>
				</Style>
				<Style
					x:Key="MoreColorButtonStyle"
					TargetType="{x:Type colorpicker:ColorPickerButton}">
					<Setter
						Property="Background"
						Value="#00FFFFFF" />
					<Setter
						Property="BorderBrush"
						Value="#99000000" />
					<Setter
						Property="Foreground"
						Value="#00FFFFFF" />
					<Setter
						Property="BorderThickness"
						Value="0" />
					<Setter
						Property="Width"
						Value="16" />
					<Setter
						Property="Height"
						Value="16" />
					<Setter
						Property="VerticalAlignment"
						Value="Center" />
					<Setter
						Property="colorpicker:ColorPickerButton.Placement"
						Value="Bottom" />
					<Setter
						Property="FrameworkElement.FocusVisualStyle"
						Value="{x:Null}" />
					<Setter
						Property="FrameworkElement.ToolTip"
						Value="{x:Static localprop:Resources.MoreColorsBtnTips}" />
					<Setter
						Property="Template">
						<Setter.Value>
							<ControlTemplate
								TargetType="{x:Type colorpicker:ColorPickerButton}">
								<Border
									x:Name="bd"
									Background="#00FFFFFF">
									<Grid>
										<Image
											x:Name="content"
											Stretch="Uniform"
											Width="16"
											Height="16"
											Source="/Style/Resources/ContextMenu/ToolbarSetting_MoreColor.png"
											SnapsToDevicePixels="False"
											UseLayoutRounding="False" />
										<Image
											x:Name="content2"
											Margin="2"
											Stretch="Uniform"
											Visibility="Collapsed"
											Width="18"
											Height="18"
											Source="/Style/Resources/ContextMenu/ToolbarSetting_MoreColor.png"
											SnapsToDevicePixels="False"
											UseLayoutRounding="False" />
										<Ellipse
											x:Name="content3"
											HorizontalAlignment="Stretch"
											VerticalAlignment="Stretch"
											Fill="#00FFFFFF"
											Stroke="{TemplateBinding Control.BorderBrush}"
											StrokeThickness="2"
											Visibility="Collapsed"
											SnapsToDevicePixels="False"
											UseLayoutRounding="False" />
									</Grid>
								</Border>
								<ControlTemplate.Triggers>
									<Trigger
										Property="UIElement.IsMouseOver"
										Value="True">
										<Setter
											TargetName="content"
											Property="Visibility"
											Value="Collapsed" />
										<Setter
											TargetName="content2"
											Property="Visibility"
											Value="Visible" />
										<Setter
											TargetName="content2"
											Property="UIElement.Opacity"
											Value="0.8" />
									</Trigger>
								</ControlTemplate.Triggers>
							</ControlTemplate>
						</Setter.Value>
					</Setter>
				</Style>
				<Style
					x:Key="ColorItemsControl"
					TargetType="{x:Type ItemsControl}">
					<Setter
						Property="Background"
						Value="#00FFFFFF" />
					<Setter
						Property="BorderThickness"
						Value="0" />
					<Setter
						Property="Foreground"
						Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
					<Setter
						Property="HorizontalAlignment"
						Value="Stretch" />
					<Setter
						Property="VerticalAlignment"
						Value="Stretch" />
					<Setter
						Property="HorizontalContentAlignment"
						Value="Left" />
					<Setter
						Property="VerticalContentAlignment"
						Value="Stretch" />
					<Setter
						Property="UIElement.SnapsToDevicePixels"
						Value="True" />
					<Setter
						Property="VirtualizingPanel.IsVirtualizing"
						Value="False" />
					<Setter
						Property="ItemsPanel">
						<Setter.Value>
							<ItemsPanelTemplate>
								<StackPanel
									Orientation="Horizontal" />
							</ItemsPanelTemplate>
						</Setter.Value>
					</Setter>
					<Setter
						Property="ItemContainerStyle">
						<Setter.Value>
							<Style
								TargetType="{x:Type ContentPresenter}">
								<Setter
									Property="HorizontalAlignment"
									Value="Stretch" />
								<Setter
									Property="VerticalAlignment"
									Value="Stretch" />
								<Setter
									Property="Margin"
									Value="6,0" />
							</Style>
						</Setter.Value>
					</Setter>
					<Setter
						Property="ItemTemplate">
						<Setter.Value>
							<DataTemplate>
								<RadioButton
									Style="{StaticResource ColorRadioButtonStyle}"
									IsChecked="{Binding IsChecked, Mode=TwoWay}"
									Background="{Binding Value, Converter={StaticResource StringBrushConverter}}"
									Tag="{Binding Value, Converter={StaticResource StringColorConverter}}"
									Command="{Binding Command}" />
							</DataTemplate>
						</Setter.Value>
					</Setter>
					<Setter
						Property="Template">
						<Setter.Value>
							<ControlTemplate
								TargetType="{x:Type ItemsControl}">
								<Border
									Background="{TemplateBinding Control.Background}"
									BorderBrush="{TemplateBinding Control.BorderBrush}"
									BorderThickness="{TemplateBinding Control.BorderThickness}"
									Padding="{TemplateBinding Control.Padding}"
									SnapsToDevicePixels="True">
									<ItemsPresenter
										SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
								</Border>
							</ControlTemplate>
						</Setter.Value>
					</Setter>
				</Style>
			</ResourceDictionary>
		</FrameworkElement.Resources>
		<StackPanel
			Orientation="Horizontal"
			Margin="6,0,0,0"
			DataContext="{Binding Path=Model, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:TextMarkupColorPicker}}">
			<ItemsControl
				x:Name="StandardColorItemsControl"
				Style="{StaticResource ColorItemsControl}"
				ItemsSource="{Binding StandardColors}" />
			<ItemsControl
				x:Name="RecentColorItemsControl"
				Style="{StaticResource ColorItemsControl}"
				ItemsSource="{Binding RecentColors}" />
			<colorpicker:ColorPickerButton
				Margin="6,0"
				Style="{StaticResource MoreColorButtonStyle}"
				RecentColorsKey="{Binding RecentColorsKey}"
				ItemClick="ColorPickerButton_ItemClick" />
		</StackPanel>
	</Grid>
</UserControl>
