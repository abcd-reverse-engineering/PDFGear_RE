<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:cv="clr-namespace:pdfeditor.Utils.Converters" xmlns:local="clr-namespace:pdfeditor.Controls.Menus" xmlns:signaturepickers="clr-namespace:pdfeditor.Controls.Signature" xmlns:stamppickers="clr-namespace:pdfeditor.Controls.Stamp" xmlns:hotkeys="clr-namespace:CommonLib.Common.HotKeys;assembly=CommonLib" xmlns:controls="clr-namespace:CommonLib.Controls;assembly=CommonLib" xmlns:colorpickers="clr-namespace:CommonLib.Controls.ColorPickers;assembly=CommonLib">
	<cv:StringBrushConverter
		x:Key="StringBrushConverter" />
	<cv:StringStrokeConverter
		x:Key="StringStrokeConverter" />
	<controls:HasHotKeyConverter
		x:Key="HasHotKeyConverter" />
	<controls:HotKeyNameConverter
		x:Key="HotKeyNameConverter" />
	<controls:StringToVisibilityConverter
		x:Key="StringToVisibilityConverter" />
	<BitmapImage
		x:Key="ToolbarContextMenuSelectedIcon"
		UriSource="/Style/Resources/Annonate/linestrokeselected.png" />
	<Style
		x:Key="{x:Type local:ToolbarButtonContextMenuItem}"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}">
		<Setter
			Property="TextOptions.TextFormattingMode"
			Value="Ideal" />
		<Setter
			Property="BorderBrush"
			Value="#FFFFFF" />
		<Setter
			Property="Background"
			Value="#FFFFFF" />
		<Setter
			Property="BorderThickness"
			Value="1" />
		<Setter
			Property="Foreground"
			Value="{DynamicResource TextBrushWhiteAndBlack}" />
		<Setter
			Property="FontSize"
			Value="12" />
		<Setter
			Property="HorizontalContentAlignment"
			Value="Stretch" />
		<Setter
			Property="HorizontalAlignment"
			Value="Stretch" />
	</Style>
	<Style
		x:Key="TranslateStyle"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}">
		<Setter
			Property="MenuItem.IsCheckable"
			Value="True" />
	</Style>
	<Style
		x:Key="SeparatorStyle"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}">
		<Setter
			Property="IsEnabled"
			Value="False" />
		<Setter
			Property="MenuItem.IsCheckable"
			Value="False" />
		<Setter
			Property="Background"
			Value="{DynamicResource PickerBackground}" />
		<Setter
			Property="BorderBrush"
			Value="#00FFFFFF" />
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type local:ToolbarButtonContextMenuItem}">
					<Grid
						Background="{TemplateBinding Control.Background}">
						<Rectangle
							HorizontalAlignment="Stretch"
							Margin="4,3,4,4"
							Fill="#D2D2D2"
							Height="1" />
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="DefaultMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}">
		<Setter
			Property="Header"
			Value="{Binding Caption}" />
		<Setter
			Property="MenuItem.Icon"
			Value="{Binding Icon}" />
		<Setter
			Property="ItemsSource"
			Value="{Binding}" />
		<Setter
			Property="MenuItem.Command"
			Value="{Binding Command}" />
		<Setter
			Property="MenuItem.CommandParameter"
			Value="{Binding}" />
		<Setter
			Property="MenuItem.IsCheckable"
			Value="{Binding IsCheckable}" />
		<Setter
			Property="MenuItem.IsChecked"
			Value="{Binding IsChecked, Mode=TwoWay}" />
		<Setter
			Property="hotkeys:HotKeyExtensions.InvokeWhen"
			Value="{Binding HotKeyInvokeWhen}" />
		<Setter
			Property="hotkeys:HotKeyExtensions.InvokeAction"
			Value="{Binding HotKeyInvokeAction}" />
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Height="24"
						Background="{DynamicResource PickerBackground}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition
								x:Name="CheckIconColumn"
								Width="0" />
							<ColumnDefinition
								x:Name="IconColumn"
								Width="30" />
							<ColumnDefinition
								Width="*" />
							<ColumnDefinition
								Width="Auto"
								MinWidth="25" />
						</Grid.ColumnDefinitions>
						<Border
							x:Name="_border"
							Grid.ColumnSpan="4"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Stretch" />
						<Image
							x:Name="_checkImg"
							Grid.Column="0"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Visibility="Collapsed"
							Source="{StaticResource ToolbarContextMenuSelectedIcon}" />
						<Image
							x:Name="_imgicon"
							Grid.Column="1"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Source="{TemplateBinding MenuItem.Icon}" />
						<TextBlock
							x:Name="_txt"
							Foreground="{DynamicResource ToolBarButtonContextMenu}"
							Grid.Column="2"
							Margin="4,0"
							VerticalAlignment="Center"
							HorizontalAlignment="Left"
							Text="{Binding Header, RelativeSource={RelativeSource TemplatedParent}}" />
						<Grid
							Column="3"
							Margin="4,0">
							<Path
								x:Name="_path"
								Visibility="Collapsed"
								HorizontalAlignment="Right"
								VerticalAlignment="Center"
								Data="M0,8 L4,4 L0,0 Z"
								Fill="#7E8A92" />
							<TextBlock
								x:Name="TextBlock_Shortcut"
								Visibility="Collapsed"
								VerticalAlignment="Center"
								Opacity="0.5"
								Foreground="{DynamicResource ToolBarButtonContextMenu}"
								HorizontalAlignment="Right"
								TextAlignment="Left"
								Width="100"
								Text="{Binding Path=(hotkeys:HotKeyExtensions.InvokeWhen), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource HotKeyNameConverter}}" />
							<TextBlock
								x:Name="TextBlock_Shortcut2"
								VerticalAlignment="Center"
								Opacity="0.5"
								Width="100"
								Foreground="{DynamicResource ToolBarButtonContextMenu}"
								HorizontalAlignment="Right"
								TextAlignment="Left"
								Text="{Binding HotKeyString}"
								Visibility="{Binding HotKeyString, Converter={StaticResource StringToVisibilityConverter}}" />
						</Grid>
						<Popup
							x:Name="SubMenuPopup"
							Placement="Right"
							AllowsTransparency="True"
							Focusable="False"
							IsOpen="{TemplateBinding MenuItem.IsSubmenuOpen}"
							PopupAnimation="Fade">
							<ScrollViewer
								VerticalScrollBarVisibility="Auto"
								HorizontalScrollBarVisibility="Disabled">
								<Border
									Name="SubmenuBorder"
									Background="#FFFFFF"
									BorderBrush="#FFD3D3D3"
									Margin="1"
									BorderThickness="1"
									SnapsToDevicePixels="True">
									<StackPanel
										IsItemsHost="True"
										KeyboardNavigation.DirectionalNavigation="Cycle" />
								</Border>
							</ScrollViewer>
						</Popup>
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger
							Property="ItemsControl.HasItems"
							Value="True">
							<Setter
								TargetName="_path"
								Property="Visibility"
								Value="Visible" />
						</Trigger>
						<Trigger
							Property="UIElement.IsMouseOver"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
							<Setter
								TargetName="_path"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="Shape.Fill" />
						</Trigger>
						<Trigger
							Property="MenuItem.IsSubmenuOpen"
							Value="True">
							<Setter
								TargetName="_border"
								Property="Border.Background"
								Value="#99FFF0F0" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
							<Setter
								TargetName="_path"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="Shape.Fill" />
						</Trigger>
						<Trigger
							Property="IsEnabled"
							Value="False">
							<Setter
								TargetName="_txt"
								Property="TextBlock.Foreground"
								Value="#FF808080" />
						</Trigger>
						<DataTrigger
							Binding="{Binding Icon}"
							Value="{x:Null}">
							<Setter
								TargetName="IconColumn"
								Property="ColumnDefinition.Width"
								Value="0" />
						</DataTrigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="ItemsControl.HasItems"
									Value="False" />
								<Condition
									Property="MenuItem.IsCheckable"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="CheckIconColumn"
								Property="ColumnDefinition.Width"
								Value="30" />
						</MultiTrigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="MenuItem.IsCheckable"
									Value="True" />
								<Condition
									Property="MenuItem.IsChecked"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_checkImg"
								Property="Visibility"
								Value="Visible" />
						</MultiTrigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="UIElement.IsMouseOver"
									Value="True" />
								<Condition
									Property="MenuItem.IsSubmenuOpen"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
						</MultiTrigger>
						<DataTrigger
							Value="true"
							Binding="{Binding Path=(hotkeys:HotKeyExtensions.InvokeWhen), RelativeSource={RelativeSource Mode=Self}, Converter={StaticResource HasHotKeyConverter}}">
							<Setter
								TargetName="TextBlock_Shortcut"
								Property="Visibility"
								Value="Visible" />
							<Setter
								TargetName="TextBlock_Shortcut2"
								Property="Visibility"
								Value="Collapsed" />
							<Setter
								TargetName="_path"
								Property="Visibility"
								Value="Collapsed" />
						</DataTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="ColorMoreMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="MenuItem.IsCheckable"
			Value="False" />
		<Setter
			Property="MenuItem.Command"
			Value="{x:Null}" />
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Height="24"
						Background="{DynamicResource PickerBackground}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition
								x:Name="CheckIconColumn"
								Width="0" />
							<ColumnDefinition
								Width="20" />
							<ColumnDefinition
								Width="*" />
							<ColumnDefinition
								Width="20" />
						</Grid.ColumnDefinitions>
						<Border
							x:Name="_border"
							Grid.ColumnSpan="4"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Stretch" />
						<Image
							x:Name="_imgicon"
							Grid.Column="1"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Source="{TemplateBinding MenuItem.Icon}" />
						<TextBlock
							x:Name="_txt"
							Foreground="{DynamicResource ToolBarButtonContextMenu}"
							Grid.Column="2"
							Margin="4,0"
							VerticalAlignment="Center"
							HorizontalAlignment="Left"
							Text="{Binding Header, RelativeSource={RelativeSource TemplatedParent}}" />
						<Path
							x:Name="_path"
							Visibility="Visible"
							Grid.Column="3"
							HorizontalAlignment="Right"
							VerticalAlignment="Center"
							Margin="4,0"
							Data="M0,8 L4,4 L0,0 Z"
							Fill="#7E8A92" />
						<Popup
							x:Name="SubMenuPopup"
							Placement="Right"
							AllowsTransparency="True"
							Focusable="False"
							IsOpen="{TemplateBinding MenuItem.IsSubmenuOpen}"
							PopupAnimation="Fade">
							<ScrollViewer
								VerticalScrollBarVisibility="Auto"
								HorizontalScrollBarVisibility="Disabled">
								<Border
									Name="SubmenuBorder"
									Background="#FFFFFF"
									BorderBrush="#FFD3D3D3"
									Margin="1"
									BorderThickness="1"
									SnapsToDevicePixels="True">
									<StackPanel
										IsItemsHost="True"
										KeyboardNavigation.DirectionalNavigation="Cycle" />
								</Border>
							</ScrollViewer>
						</Popup>
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger
							Property="UIElement.IsMouseOver"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
							<Setter
								TargetName="_path"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="Shape.Fill" />
						</Trigger>
						<Trigger
							Property="MenuItem.IsSubmenuOpen"
							Value="True">
							<Setter
								TargetName="_border"
								Property="Border.Background"
								Value="#99FFF0F0" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
							<Setter
								TargetName="_path"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="Shape.Fill" />
						</Trigger>
						<Trigger
							Property="IsEnabled"
							Value="False">
							<Setter
								TargetName="_txt"
								Property="TextBlock.Foreground"
								Value="#FF808080" />
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="UIElement.IsMouseOver"
									Value="True" />
								<Condition
									Property="MenuItem.IsSubmenuOpen"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
						</MultiTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="ColorPickerMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="MenuItem.IsCheckable"
			Value="False" />
		<Setter
			Property="MenuItem.StaysOpenOnClick"
			Value="True" />
		<Setter
			Property="MenuItem.Command"
			Value="{x:Null}" />
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Background="{DynamicResource PickerBackground}">
						<colorpickers:ColorPicker
							x:Name="ColorPicker" />
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="SignaturePickerMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="MenuItem.IsCheckable"
			Value="False" />
		<Setter
			Property="MenuItem.StaysOpenOnClick"
			Value="True" />
		<Setter
			Property="MenuItem.Command"
			Value="{x:Null}" />
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Background="{DynamicResource PickerBackground}">
						<signaturepickers:SignaturePicker
							x:Name="SignaturePicker" />
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="StampPickerMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="MenuItem.IsCheckable"
			Value="False" />
		<Setter
			Property="MenuItem.StaysOpenOnClick"
			Value="True" />
		<Setter
			Property="MenuItem.Command"
			Value="{x:Null}" />
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Background="{DynamicResource PickerBackground}">
						<stamppickers:StampPicker
							x:Name="StampPicker"
							GroupName="{Binding Caption}" />
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="ColorMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Height="24"
						Background="{DynamicResource PickerBackground}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition
								x:Name="CheckIconColumn"
								Width="30" />
							<ColumnDefinition
								Width="0" />
							<ColumnDefinition
								Width="0" />
							<ColumnDefinition
								Width="30" />
							<ColumnDefinition
								Width="*" />
						</Grid.ColumnDefinitions>
						<Border
							x:Name="_border"
							Grid.ColumnSpan="5"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Stretch" />
						<Image
							x:Name="_checkImg"
							Grid.Column="0"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Visibility="Collapsed"
							Source="{StaticResource ToolbarContextMenuSelectedIcon}" />
						<Image
							x:Name="_imgicon"
							Grid.Column="1"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Source="{TemplateBinding MenuItem.Icon}" />
						<TextBlock
							x:Name="_txt"
							Foreground="{DynamicResource ToolBarButtonContextMenu}"
							Grid.Column="2"
							Margin="4,0"
							VerticalAlignment="Center"
							HorizontalAlignment="Left"
							Text="{Binding Header, RelativeSource={RelativeSource TemplatedParent}}" />
						<Grid
							Column="3"
							Width="16"
							Height="16"
							HorizontalAlignment="Right"
							VerticalAlignment="Center"
							Margin="0,0,8,0"
							DataContext="{Binding TagData}">
							<Ellipse
								x:Name="_colorIndicator"
								HorizontalAlignment="Stretch"
								VerticalAlignment="Stretch"
								SnapsToDevicePixels="False"
								UseLayoutRounding="False"
								Fill="{Binding MenuItemValue, Converter={StaticResource StringBrushConverter}}"
								Stroke="{Binding MenuItemValue, ConverterParameter=Stroke, Converter={StaticResource StringStrokeConverter}}" />
							<Line
								StrokeThickness="1"
								SnapsToDevicePixels="False"
								UseLayoutRounding="False"
								X1="2.8"
								Y1="2.8"
								X2="13.2"
								Y2="12.2"
								Stroke="{Binding MenuItemValue, ConverterParameter=Fill, Converter={StaticResource StringStrokeConverter}}" />
						</Grid>
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger
							Property="ItemsControl.HasItems"
							Value="True">
							<Setter
								TargetName="CheckIconColumn"
								Property="ColumnDefinition.Width"
								Value="0" />
						</Trigger>
						<Trigger
							Property="UIElement.IsMouseOver"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
						</Trigger>
						<Trigger
							Property="MenuItem.IsSubmenuOpen"
							Value="True">
							<Setter
								TargetName="_border"
								Property="Border.Background"
								Value="#99FFF0F0" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
						</Trigger>
						<Trigger
							Property="IsEnabled"
							Value="False">
							<Setter
								TargetName="_txt"
								Property="TextBlock.Foreground"
								Value="#FF808080" />
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="MenuItem.IsCheckable"
									Value="True" />
								<Condition
									Property="MenuItem.IsChecked"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_checkImg"
								Property="Visibility"
								Value="Visible" />
						</MultiTrigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="UIElement.IsMouseOver"
									Value="True" />
								<Condition
									Property="MenuItem.IsSubmenuOpen"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
						</MultiTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="StrokeThicknessMenuItem"
		TargetType="{x:Type MenuItem}">
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Height="24"
						Background="{DynamicResource PickerBackground}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition
								x:Name="CheckIconColumn"
								Width="30" />
							<ColumnDefinition
								Width="0" />
							<ColumnDefinition
								Width="*" />
							<ColumnDefinition
								Width="25" />
						</Grid.ColumnDefinitions>
						<Border
							x:Name="_border"
							Grid.ColumnSpan="4"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Stretch" />
						<Image
							x:Name="_checkImg"
							Grid.Column="0"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Visibility="Collapsed"
							Source="{StaticResource ToolbarContextMenuSelectedIcon}" />
						<Image
							x:Name="_imgicon"
							Grid.Column="1"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Source="{TemplateBinding MenuItem.Icon}" />
						<TextBlock
							x:Name="_txt"
							Foreground="{DynamicResource ToolBarButtonContextMenu}"
							Grid.Column="2"
							Margin="4,0"
							VerticalAlignment="Center"
							HorizontalAlignment="Left"
							Text="{Binding Header, RelativeSource={RelativeSource TemplatedParent}}" />
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger
							Property="ItemsControl.HasItems"
							Value="True">
							<Setter
								TargetName="CheckIconColumn"
								Property="ColumnDefinition.Width"
								Value="0" />
						</Trigger>
						<Trigger
							Property="UIElement.IsMouseOver"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
						</Trigger>
						<Trigger
							Property="MenuItem.IsSubmenuOpen"
							Value="True">
							<Setter
								TargetName="_border"
								Property="Border.Background"
								Value="#99FFF0F0" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
						</Trigger>
						<Trigger
							Property="IsEnabled"
							Value="False">
							<Setter
								TargetName="_txt"
								Property="TextBlock.Foreground"
								Value="#FF808080" />
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="MenuItem.IsCheckable"
									Value="True" />
								<Condition
									Property="MenuItem.IsChecked"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_checkImg"
								Property="Visibility"
								Value="Visible" />
						</MultiTrigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="UIElement.IsMouseOver"
									Value="True" />
								<Condition
									Property="MenuItem.IsSubmenuOpen"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
						</MultiTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="StampPresetsMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="hotkeys:HotKeyExtensions.InvokeWhen"
			Value="{Binding HotKeyInvokeWhen}" />
		<Setter
			Property="hotkeys:HotKeyExtensions.InvokeAction"
			Value="{Binding HotKeyInvokeAction}" />
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Height="30"
						Background="{DynamicResource PickerBackground}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition
								Width="30" />
							<ColumnDefinition
								Width="*" />
							<ColumnDefinition
								Width="Auto"
								MinWidth="25" />
						</Grid.ColumnDefinitions>
						<Border
							x:Name="_border"
							Grid.ColumnSpan="3"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Stretch" />
						<Image
							x:Name="_imgicon"
							Grid.Column="0"
							Width="14"
							Height="14"
							Stretch="Uniform"
							Source="{TemplateBinding MenuItem.Icon}" />
						<TextBlock
							x:Name="_txt"
							MaxWidth="150"
							TextTrimming="CharacterEllipsis"
							Foreground="{DynamicResource ToolBarButtonContextMenu}"
							Grid.Column="1"
							Margin="4,0"
							VerticalAlignment="Center"
							HorizontalAlignment="Left">
							<controls:AutoTooltipTextBlock
								HorizontalAlignment="Center"
								Text="{Binding Header, RelativeSource={RelativeSource TemplatedParent}}" />
						</TextBlock>
						<Grid
							Column="2"
							Margin="4,0">
							<Path
								x:Name="_path"
								Visibility="Collapsed"
								HorizontalAlignment="Right"
								VerticalAlignment="Center"
								Data="M0,8 L4,4 L0,0 Z"
								Fill="#7E8A92" />
							<TextBlock
								x:Name="TextBlock_Shortcut"
								Visibility="Collapsed"
								VerticalAlignment="Center"
								Opacity="0.5"
								Foreground="{DynamicResource ToolBarButtonContextMenu}"
								HorizontalAlignment="Right"
								Text="{Binding Path=(hotkeys:HotKeyExtensions.InvokeWhen), RelativeSource={RelativeSource Mode=TemplatedParent}, Converter={StaticResource HotKeyNameConverter}}" />
							<TextBlock
								x:Name="TextBlock_Shortcut2"
								VerticalAlignment="Center"
								Opacity="0.5"
								Foreground="{DynamicResource ToolBarButtonContextMenu}"
								HorizontalAlignment="Right"
								Text="{Binding HotKeyString}"
								Visibility="{Binding HotKeyString, Converter={StaticResource StringToVisibilityConverter}}" />
						</Grid>
						<Popup
							x:Name="SubMenuPopup"
							Placement="Right"
							AllowsTransparency="True"
							Focusable="False"
							IsOpen="{TemplateBinding MenuItem.IsSubmenuOpen}"
							PopupAnimation="Fade">
							<ScrollViewer
								VerticalScrollBarVisibility="Auto"
								HorizontalScrollBarVisibility="Disabled">
								<Border
									Name="SubmenuBorder"
									Background="{DynamicResource SolidBrushWhiteAndBlack}"
									BorderBrush="{DynamicResource ContextMenuBorder}"
									Margin="1"
									BorderThickness="1"
									SnapsToDevicePixels="True">
									<StackPanel
										IsItemsHost="True"
										KeyboardNavigation.DirectionalNavigation="Cycle" />
								</Border>
							</ScrollViewer>
						</Popup>
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger
							Property="ItemsControl.HasItems"
							Value="True">
							<Setter
								TargetName="_path"
								Property="Visibility"
								Value="Visible" />
						</Trigger>
						<Trigger
							Property="UIElement.IsMouseOver"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
						</Trigger>
						<Trigger
							Property="MenuItem.IsSubmenuOpen"
							Value="True">
							<Setter
								TargetName="_border"
								Property="Border.Background"
								Value="#99FFF0F0" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
						</Trigger>
						<Trigger
							Property="IsEnabled"
							Value="False">
							<Setter
								TargetName="_txt"
								Property="TextBlock.Foreground"
								Value="#FF808080" />
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="UIElement.IsMouseOver"
									Value="True" />
								<Condition
									Property="MenuItem.IsSubmenuOpen"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
						</MultiTrigger>
						<DataTrigger
							Value="true"
							Binding="{Binding Path=(hotkeys:HotKeyExtensions.InvokeWhen), RelativeSource={RelativeSource Mode=Self}, Converter={StaticResource HasHotKeyConverter}}">
							<Setter
								TargetName="TextBlock_Shortcut"
								Property="Visibility"
								Value="Visible" />
							<Setter
								TargetName="TextBlock_Shortcut2"
								Property="Visibility"
								Value="Collapsed" />
							<Setter
								TargetName="_path"
								Property="Visibility"
								Value="Collapsed" />
						</DataTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="SpeedPresetsMenuItemModel"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource StampPresetsMenuItem}">
		<Setter
			Property="IsEnabled"
			Value="{Binding IsEnabled}" />
	</Style>
	<Style
		x:Key="ConvertMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Height="24"
						Background="{DynamicResource PickerBackground}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition
								Width="30" />
							<ColumnDefinition
								Width="*" />
						</Grid.ColumnDefinitions>
						<Border
							x:Name="_border"
							Grid.ColumnSpan="2"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Stretch" />
						<Image
							x:Name="_imgicon"
							Grid.Column="0"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Source="{TemplateBinding MenuItem.Icon}" />
						<TextBlock
							x:Name="_txt"
							Foreground="{DynamicResource ToolBarButtonContextMenu}"
							Grid.Column="1"
							Margin="4,0"
							VerticalAlignment="Center"
							HorizontalAlignment="Left"
							Text="{Binding Header, RelativeSource={RelativeSource TemplatedParent}}" />
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger
							Property="UIElement.IsMouseOver"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
						</Trigger>
						<Trigger
							Property="IsEnabled"
							Value="False">
							<Setter
								TargetName="_txt"
								Property="TextBlock.Foreground"
								Value="#FF808080" />
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="BackGroudMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Height="24"
						Background="{DynamicResource PickerBackground}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition
								x:Name="CheckIconColumn"
								Width="30" />
							<ColumnDefinition
								Width="*" />
						</Grid.ColumnDefinitions>
						<Border
							x:Name="_border"
							Grid.ColumnSpan="2"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Stretch" />
						<Image
							x:Name="_checkImg"
							Grid.Column="0"
							Width="12"
							Height="12"
							Stretch="Uniform"
							Visibility="Collapsed"
							Source="{StaticResource ToolbarContextMenuSelectedIcon}" />
						<TextBlock
							x:Name="_txt"
							Foreground="{DynamicResource ToolBarButtonContextMenu}"
							Grid.Column="1"
							Margin="4,0"
							VerticalAlignment="Center"
							HorizontalAlignment="Left"
							Text="{Binding Header, RelativeSource={RelativeSource TemplatedParent}}" />
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger
							Property="UIElement.IsMouseOver"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
							<Setter
								TargetName="_txt"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="TextBlock.Foreground" />
						</Trigger>
						<Trigger
							Property="IsEnabled"
							Value="False">
							<Setter
								TargetName="_txt"
								Property="TextBlock.Foreground"
								Value="#FF808080" />
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="MenuItem.IsCheckable"
									Value="True" />
								<Condition
									Property="MenuItem.IsChecked"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_checkImg"
								Property="Visibility"
								Value="Visible" />
						</MultiTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style
		x:Key="PresetsMenuItem"
		TargetType="{x:Type local:ToolbarButtonContextMenuItem}"
		BasedOn="{StaticResource DefaultMenuItem}">
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type MenuItem}">
					<Grid
						Height="36"
						Background="{DynamicResource PickerBackground}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition
								x:Name="_col"
								Width="Auto" />
							<ColumnDefinition
								Width="*" />
						</Grid.ColumnDefinitions>
						<Border
							x:Name="_border"
							HorizontalAlignment="Stretch"
							Grid.Column="0"
							Grid.ColumnSpan="2"
							VerticalAlignment="Stretch"
							Background="#00FFFFFF" />
						<stamppickers:StampDefaultTextPreview
							Grid.Column="1"
							Width="126"
							Margin="3"
							IsHitTestVisible="False"
							StampModel="{Binding TagData.MenuItemValue}" />
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger
							Property="UIElement.IsMouseOver"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
						</Trigger>
						<Trigger
							Property="MenuItem.IsSubmenuOpen"
							Value="True">
							<Setter
								TargetName="_border"
								Value="{DynamicResource TextBrushWhiteAndBlack}"
								Property="Border.Background" />
							<Setter
								TargetName="_border"
								Property="Width"
								Value="{Binding ElementName=_txt, Path=ActualWidth}" />
						</Trigger>
						<Trigger
							Property="IsEnabled"
							Value="False" />
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition
									Property="UIElement.IsMouseOver"
									Value="True" />
								<Condition
									Property="MenuItem.IsSubmenuOpen"
									Value="True" />
							</MultiTrigger.Conditions>
							<Setter
								TargetName="_border"
								Value="{DynamicResource BtnInfoMouseOverColor}"
								Property="Border.Background" />
						</MultiTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<local:ToolbarButtonContextMenuStyleSelector
		x:Key="ToolbarButtonContextMenuStyleSelector"
		SeparatorStyle="{StaticResource SeparatorStyle}"
		ColorItemStyle="{StaticResource ColorMenuItem}"
		StrokeThicknessItemStyle="{StaticResource StrokeThicknessMenuItem}"
		ConvertItemStyle="{StaticResource ConvertMenuItem}"
		BackgroundStyle="{StaticResource BackGroudMenuItem}"
		StampItemStyle="{StaticResource StampPresetsMenuItem}"
		StampPresetsMenuItem="{StaticResource PresetsMenuItem}"
		DefaultItemStyle="{StaticResource DefaultMenuItem}"
		ColorMoreItemStyle="{StaticResource ColorMoreMenuItem}"
		ColorPickerItemStyle="{StaticResource ColorPickerMenuItem}"
		SignaturePickerItemStyle="{StaticResource SignaturePickerMenuItem}"
		SpeedPresetsMenuItem="{StaticResource SpeedPresetsMenuItemModel}"
		StampPickerItemStyle="{StaticResource StampPickerMenuItem}" />
	<Style
		x:Key="{x:Type local:ToolbarButtonContextMenu}"
		TargetType="{x:Type local:ToolbarButtonContextMenu}">
		<Setter
			Property="UIElement.SnapsToDevicePixels"
			Value="True" />
		<Setter
			Property="RenderOptions.ClearTypeHint"
			Value="Enabled" />
		<Setter
			Property="TextOptions.TextFormattingMode"
			Value="Ideal" />
		<Setter
			Property="BorderBrush"
			Value="{DynamicResource SolidBrushWhiteAndBlack}" />
		<Setter
			Property="Background"
			Value="{DynamicResource SolidBrushWhiteAndBlack}" />
		<Setter
			Property="BorderThickness"
			Value="1" />
		<Setter
			Property="Grid.IsSharedSizeScope"
			Value="True" />
		<Setter
			Property="ContextMenu.HasDropShadow"
			Value="True" />
		<Setter
			Property="ItemContainerStyleSelector"
			Value="{StaticResource ToolbarButtonContextMenuStyleSelector}" />
		<Setter
			Property="Template">
			<Setter.Value>
				<ControlTemplate
					TargetType="{x:Type ContextMenu}">
					<Grid>
						<Border
							x:Name="Border"
							BorderBrush="{DynamicResource ContextMenuBorder}"
							BorderThickness="1"
							Background="{TemplateBinding Control.Background}"
							Padding="{TemplateBinding Control.Padding}"
							SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}">
							<ItemsPresenter
								x:Name="ItemsPresenter"
								KeyboardNavigation.DirectionalNavigation="Cycle"
								Grid.IsSharedSizeScope="True"
								Margin="0"
								SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}"
								KeyboardNavigation.TabNavigation="Cycle" />
						</Border>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
</ResourceDictionary>
