<Window
	x:Class="pdfeditor.Controls.DigitalSignatures.CreateDigitalSignatureDialog" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:local="clr-namespace:pdfeditor.Controls.DigitalSignatures" xmlns:localprop="clr-namespace:pdfeditor.Properties" xmlns:controls="clr-namespace:CommonLib.Controls;assembly=CommonLib" xmlns:converter="clr-namespace:pdfeditor.Utils.Converters" xmlns:appTheme="clr-namespace:CommonLib.AppTheme;assembly=CommonLib"
	ResizeMode="NoResize"
	SizeToContent="Height"
	SnapsToDevicePixels="True"
	Title="{x:Static localprop:Resources.SigDialogDigSignBtn2}"
	MinHeight="380"
	Width="500"
	Background="{DynamicResource SolidBrushWhiteAndBlack}"
	TextElement.Foreground="{DynamicResource TextBrushWhiteAndBlack}">
	<Grid
		Margin="20">
		<Grid.RowDefinitions>
			<RowDefinition
				Height="*" />
			<RowDefinition
				Height="Auto" />
		</Grid.RowDefinitions>
		<FrameworkElement.Resources>
			<ResourceDictionary>
				<ResourceDictionary.MergedDictionaries>
					<ResourceDictionary
						Source="/Controls/DigitalSignatures/DigitalSignatureControlStyles.xaml" />
				</ResourceDictionary.MergedDictionaries>
				<converter:BooleanReverseConverter
					x:Key="BooleanReverseConverter" />
				<converter:BooleanToVisibilityConverter
					x:Key="BooleanToVisibilityConverter" />
				<converter:BooleanToVisibilityReverseConverter
					x:Key="BooleanToVisibilityReverseConverter" />
				<Style
					x:Key="CommonHeaderedControlStyle"
					TargetType="{x:Type HeaderedContentControl}"
					BasedOn="{StaticResource DigitalSignatureHeaderedControlStyle}">
					<Setter
						Property="MinHeight"
						Value="38" />
				</Style>
			</ResourceDictionary>
		</FrameworkElement.Resources>
		<StackPanel
			HorizontalAlignment="Stretch"
			Grid.IsSharedSizeScope="True">
			<HeaderedContentControl
				Style="{StaticResource CommonHeaderedControlStyle}"
				Header="{x:Static localprop:Resources.CreateDigSignDialogCertFile}">
				<Grid>
					<Grid.ColumnDefinitions>
						<ColumnDefinition
							Width="*" />
						<ColumnDefinition
							Width="Auto" />
						<ColumnDefinition
							Width="Auto" />
					</Grid.ColumnDefinitions>
					<FrameworkElement.Resources>
						<ResourceDictionary>
							<ResourceDictionary.MergedDictionaries>
								<ResourceDictionary>
									<SolidColorBrush
										x:Key="ExpirationDateExpiredBrush"
										Color="#FF0000" />
									<DataTemplate
										x:Key="ComboBoxItemTemplate">
										<TextBlock
											Text="{Binding DisplayName}" />
									</DataTemplate>
									<DataTemplate
										x:Key="DropDownItemTemplate">
										<Grid>
											<Grid.RowDefinitions>
												<RowDefinition
													Height="*" />
												<RowDefinition
													Height="Auto" />
											</Grid.RowDefinitions>
											<Grid.ColumnDefinitions>
												<ColumnDefinition
													Width="*" />
												<ColumnDefinition
													Width="Auto"
													SharedSizeGroup="CreateDigSign_ExpColumn" />
											</Grid.ColumnDefinitions>
											<TextBlock
												Margin="0,0,0,2"
												Text="{Binding DisplayName, Mode=OneWay}" />
											<TextBlock
												Grid.Row="1"
												FontSize="10"
												Opacity="0.85">
												<Run
													Text="{x:Static localprop:Resources.CreateDigSignCertComboBoxItemIssuer}" />
												<Run
													Text="{Binding Issuer, Mode=OneWay}" />
											</TextBlock>
											<TextBlock
												FontSize="10"
												Opacity="0.85"
												Margin="4,0,0,0"
												Grid.RowSpan="2"
												Grid.Column="1"
												HorizontalAlignment="Left"
												VerticalAlignment="Bottom"
												Visibility="{Binding IsExpired, Converter='{StaticResource BooleanToVisibilityReverseConverter}'}">
												<Run
													Text="{x:Static localprop:Resources.CreateDigSignCertComboBoxItemExpiration}" />
												<Run
													Text="{Binding ExpirationDateString, Mode=OneWay}" />
											</TextBlock>
											<TextBlock
												Foreground="{StaticResource ExpirationDateExpiredBrush}"
												FontSize="10"
												Opacity="0.85"
												Margin="4,0,0,0"
												Grid.RowSpan="2"
												Grid.Column="1"
												HorizontalAlignment="Left"
												VerticalAlignment="Bottom"
												Visibility="{Binding IsExpired, Converter='{StaticResource BooleanToVisibilityConverter}'}">
												<Run
													Text="{x:Static localprop:Resources.CreateDigSignCertComboBoxItemExpiration}" />
												<Run
													Text="{Binding ExpirationDateString, Mode=OneWay}" />
											</TextBlock>
										</Grid>
									</DataTemplate>
									<local:CertComboBoxItemTemplateSelector
										x:Key="CertComboBoxItemTemplateSelector"
										ComboBoxItemTemplate="{StaticResource ComboBoxItemTemplate}"
										DropDownItemTemplate="{StaticResource DropDownItemTemplate}" />
								</ResourceDictionary>
							</ResourceDictionary.MergedDictionaries>
						</ResourceDictionary>
					</FrameworkElement.Resources>
					<ComboBox
						x:Name="CertComboBox"
						Style="{StaticResource DigitalSignatureComboboxStyle}"
						ItemTemplateSelector="{StaticResource CertComboBoxItemTemplateSelector}"
						SelectionChanged="CertComboBox_SelectionChanged">
						<ItemsControl.ItemContainerStyle>
							<Style
								TargetType="{x:Type ComboBoxItem}">
								<Setter
									Property="Height"
									Value="Auto" />
								<Setter
									Property="HorizontalAlignment"
									Value="Stretch" />
								<Setter
									Property="HorizontalContentAlignment"
									Value="Stretch" />
								<Setter
									Property="Padding"
									Value="4,3" />
								<Setter
									Property="IsEnabled"
									Value="{Binding IsExpired, Converter='{StaticResource BooleanReverseConverter}'}" />
							</Style>
						</ItemsControl.ItemContainerStyle>
					</ComboBox>
					<controls:HyperlinkButton
						x:Name="CertInfoButton"
						Grid.Column="1"
						Margin="8,0,0,0"
						VerticalAlignment="Stretch"
						VerticalContentAlignment="Center"
						Content="{x:Static localprop:Resources.DigSignCertInfoBtn}"
						Click="CertInfoButton_Click" />
				</Grid>
			</HeaderedContentControl>
			<HeaderedContentControl
				x:Name="CertPasswordGroup"
				Style="{StaticResource CommonHeaderedControlStyle}"
				Header="{x:Static localprop:Resources.CreateDigSignDialogCertPassword}"
				Visibility="{Binding ElementName=CertComboBox, Path=SelectedItem.NeedPassword, Converter='{StaticResource BooleanToVisibilityConverter}', FallbackValue='{x:Static Visibility.Collapsed}', TargetNullValue='{x:Static Visibility.Collapsed}'}">
				<PasswordBox
					x:Name="CertPasswordBox"
					Padding="4,4"
					Style="{StaticResource DefaultPasswordBoxStyle}" />
			</HeaderedContentControl>
			<HeaderedContentControl
				Style="{StaticResource CommonHeaderedControlStyle}">
				<Button
					x:Name="BrowserIdFileButton"
					Style="{StaticResource DialogButtonStyle}"
					HorizontalAlignment="Left"
					MinWidth="80"
					Padding="8,4"
					Margin="0,0,0,4"
					Click="BrowserIdFileButton_Click">
					<StackPanel
						Orientation="Horizontal">
						<TextBlock
							Text="+"
							FontSize="14"
							Margin="0,0,4,0"
							VerticalAlignment="Center" />
						<TextBlock
							Text="{x:Static localprop:Resources.CreateDigSignDialogBrowserItem}"
							VerticalAlignment="Center" />
					</StackPanel>
				</Button>
			</HeaderedContentControl>
			<HeaderedContentControl
				Style="{StaticResource CommonHeaderedControlStyle}"
				Header="{x:Static localprop:Resources.DigSignPropReason}">
				<ComboBox
					x:Name="ReasonComboBox"
					IsEditable="True"
					Style="{StaticResource DigitalSignatureComboboxStyle}"
					TextBoxBase.TextChanged="ReasonComboBox_TextChanged" />
			</HeaderedContentControl>
			<HeaderedContentControl
				Style="{StaticResource CommonHeaderedControlStyle}"
				Header="{x:Static localprop:Resources.DigSignPropLocation}">
				<TextBox
					x:Name="LocationText"
					Padding="2,4"
					Style="{StaticResource DefaultTextBoxStyle}"
					TextChanged="LocationText_TextChanged" />
			</HeaderedContentControl>
			<Rectangle
				HorizontalAlignment="Stretch"
				Height="1"
				Margin="0,12"
				Fill="{DynamicResource MainViewFontSizeBorder}" />
			<Border
				x:Name="PreviewImageBorder"
				Margin="0,12,0,0"
				HorizontalAlignment="Stretch"
				BorderBrush="{DynamicResource MainViewFontSizeBorder}"
				BorderThickness="1"
				Background="#FFFFFF"
				SizeChanged="PreviewImageBorder_SizeChanged">
				<Image
					x:Name="PreviewImage"
					HorizontalAlignment="Stretch"
					VerticalAlignment="Stretch"
					Stretch="None" />
			</Border>
			<CheckBox
				x:Name="CertificatedCheckBox"
				Content="{x:Static localprop:Resources.CreateDigSignDialogCertificatedCheckbox}"
				Margin="0,12,0,0"
				Padding="4,0.5,0,0"
				Visibility="Collapsed" />
		</StackPanel>
		<StackPanel
			Grid.Row="1"
			Margin="0,20,0,0"
			Orientation="Horizontal"
			HorizontalAlignment="Right"
			VerticalAlignment="Center">
			<Button
				x:Name="btnCancel"
				Style="{StaticResource DialogButtonStyle}"
				Content="{x:Static localprop:Resources.WinBtnCancelContent}"
				Width="80"
				FontSize="12"
				IsCancel="True" />
			<Button
				x:Name="btnOk"
				Style="{StaticResource PrimaryDialogButtonStyle}"
				Content="{x:Static localprop:Resources.CreateDigSignDialogSignBtn}"
				Width="80"
				Margin="10,0,0,0"
				IsDefault="True"
				FontSize="12"
				Click="btnOk_Click" />
		</StackPanel>
	</Grid>
</Window>
